<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1.0"/>
  <title>LCMS — Column Reference</title>
  <style>
    :root{--bg:#0f1117;--surface:#1a1d27;--surface2:#21253a;--accent:#6c8ef5;--accent2:#a78bfa;--green:#34d399;--orange:#fb923c;--text:#e2e8f0;--muted:#94a3b8;--border:#2d3351;--code-bg:#0d1117;}
    *{box-sizing:border-box;margin:0;padding:0;}
    body{font-family:'Segoe UI',system-ui,sans-serif;background:var(--bg);color:var(--text);line-height:1.7;}
    nav{background:var(--surface);border-bottom:1px solid var(--border);padding:0 32px;display:flex;align-items:center;gap:32px;height:56px;}
    nav .logo{font-weight:700;font-size:.95rem;color:var(--accent);text-decoration:none;}
    nav a{color:var(--muted);text-decoration:none;font-size:.88rem;}
    nav a:hover,nav a.active{color:var(--text);}
    .page-header{padding:40px 0 30px;border-bottom:1px solid var(--border);text-align:center;background:var(--surface);}
    .page-header h1{font-size:clamp(1.6rem,3vw,2.2rem);font-weight:700;letter-spacing:-.02em;}
    .page-header p{color:var(--muted);margin-top:8px;font-size:.95rem;}
    .container{max-width:860px;margin:0 auto;padding:32px 24px 80px;}
    .tag{display:inline-block;font-size:.68rem;font-weight:600;letter-spacing:.08em;text-transform:uppercase;padding:2px 9px;border-radius:999px;margin-right:6px;}
    .tag-in{background:rgba(108,142,245,.15);color:var(--accent);border:1px solid rgba(108,142,245,.3);}
    .tag-out{background:rgba(52,211,153,.12);color:var(--green);border:1px solid rgba(52,211,153,.3);}
    .group-label{font-size:.72rem;font-weight:600;text-transform:uppercase;letter-spacing:.1em;color:var(--muted);margin-bottom:10px;margin-top:30px;}
    .col-cards{display:flex;flex-direction:column;gap:12px;}
    .col-card{background:var(--surface);border:1px solid var(--border);border-radius:12px;padding:20px 22px;transition:border-color .2s;}
    .col-card:hover{border-color:var(--accent);}
    .col-top{display:flex;align-items:center;gap:10px;margin-bottom:10px;}
    code{font-family:monospace;background:var(--code-bg);border:1px solid var(--border);border-radius:5px;padding:2px 8px;font-size:.88em;color:var(--accent2);}
    .col-desc{font-size:.875rem;color:var(--muted);}
    .col-note{margin-top:8px;font-size:.81rem;color:var(--muted);font-style:italic;}
    footer{text-align:center;padding:24px;border-top:1px solid var(--border);font-size:.77rem;color:var(--muted);}
  </style>
</head>
<body>
<nav>
  <a class="logo" href="index.html">⚗️ LCMS Pipeline</a>
  <a href="guide.html">Guide</a>
  <a href="functions.html">Functions</a>
  <a href="columns.html" class="active">Columns</a>
  <a href="checklist.html">Checklist</a>
</nav>
<div class="page-header">
  <h1>Column Reference</h1>
  <p>Every input and output column — names, types, and how values are computed</p>
</div>
<div class="container">

  <div class="group-label">Input Columns — required in every sheet</div>
  <div class="col-cards">
    <div class="col-card">
      <div class="col-top"><span class="tag tag-in">Input</span><code>METABOLITE NAME</code></div>
      <p class="col-desc">The name of the metabolite for each measurement row. The script automatically capitalises the first letter of each entry using <code>.str.capitalize()</code>, so mixed-case values are normalised.</p>
      <p class="col-note">Type: text string. Required — missing values cause grouping errors.</p>
    </div>
    <div class="col-card">
      <div class="col-top"><span class="tag tag-in">Input</span><code>AREA</code></div>
      <p class="col-desc">The numeric peak area for that measurement. The script converts this column to numeric using <code>pd.to_numeric(..., errors='coerce')</code>, so scientific notation (e.g. <code>1.23e+06</code>) is handled automatically. Rows that cannot be converted are dropped.</p>
      <p class="col-note">Type: numeric (int or float, scientific notation ok). Non-numeric rows silently dropped.</p>
    </div>
  </div>

  <div class="group-label">Output Columns — produced after duplicate analysis</div>
  <div class="col-cards">
    <div class="col-card">
      <div class="col-top"><span class="tag tag-out">Output</span><code>Area</code></div>
      <p class="col-desc">The mean peak area across all replicates retained after outlier removal (|Z| &lt; 1.5). This is the primary summary value used downstream.</p>
      <p class="col-note">Computed as: mean of retained AREA values per metabolite.</p>
    </div>
    <div class="col-card">
      <div class="col-top"><span class="tag tag-out">Output</span><code>n</code></div>
      <p class="col-desc">The number of replicate measurements that passed the outlier filter and contributed to the mean. Useful for assessing confidence — a low <code>n</code> means most replicates were flagged as outliers.</p>
      <p class="col-note">Computed as: count of rows per metabolite group after filtering.</p>
    </div>
    <div class="col-card">
      <div class="col-top"><span class="tag tag-out">Output</span><code>z_score</code></div>
      <p class="col-desc">A Python list of Z-scores for each retained measurement. The Z-score is computed as <code>(x − mean) / std</code> within each metabolite group. Metabolites with only one replicate (where std = 0 or NaN) receive a Z-score of 0.</p>
      <p class="col-note">Filter threshold: measurements with |Z| ≥ 1.5 are removed before aggregation.</p>
    </div>
    <div class="col-card">
      <div class="col-top"><span class="tag tag-out">Output</span><code>std</code></div>
      <p class="col-desc">The standard deviation of peak areas across retained replicates. Set to 0 when only a single measurement remains after filtering (to avoid NaN propagation).</p>
      <p class="col-note">Computed as: std of retained AREA values; NaN filled to 0.</p>
    </div>
  </div>

</div>
<footer>LCMS Metabolomics Pipeline · Author: Kartika · Python 3 · pandas · openpyxl · xlsxwriter</footer>
</body>
</html>
